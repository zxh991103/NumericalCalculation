<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><style>body {
  max-width: 980px;
  border: 1px solid #ddd;
  outline: 1300px solid #fff;
  margin: 16px auto;
}

body .markdown-body
{
  padding: 45px;
}

@font-face {
  font-family: fontawesome-mini;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #333333;
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body b,
.markdown-body strong {
  font-weight: bold;
}

.markdown-body mark {
  background: #ff0;
  color: #000;
  font-style: italic;
  font-weight: bold;
}

.markdown-body sub,
.markdown-body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
.markdown-body sup {
  top: -0.5em;
}
.markdown-body sub {
  bottom: -0.25em;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre,
.markdown-body samp {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body .codehilitetable {
  border: 0;
  border-spacing: 0;
}

.markdown-body .codehilitetable tr {
  border: 0;
}

.markdown-body .codehilitetable pre,
.markdown-body .codehilitetable div.codehilite {
  margin: 0;
}

.markdown-body .linenos,
.markdown-body .code,
.markdown-body .codehilitetable td {
  border: 0;
  padding: 0;
}

.markdown-body td:not(.linenos) .linenodiv {
  padding: 0 !important;
}

.markdown-body .code {
  width: 100%;
}

.markdown-body .linenos div pre,
.markdown-body .linenodiv pre,
.markdown-body .linenodiv {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-left-radius: 3px;
  -webkit-border-bottom-left-radius: 3px;
  -moz-border-radius-topleft: 3px;
  -moz-border-radius-bottomleft: 3px;
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
}

.markdown-body .code div pre,
.markdown-body .code div {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-right-radius: 3px;
  -webkit-border-bottom-right-radius: 3px;
  -moz-border-radius-topright: 3px;
  -moz-border-radius-bottomright: 3px;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
}

.markdown-body * {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
  line-height: 1.4;
}

.markdown-body a {
  color: #4183c4;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:focus,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before,
.markdown-body hr:after {
  display: table;
  content: " ";
}

.markdown-body hr:after {
  clear: both;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre,
.markdown-body samp {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #e7e7e7;
  background-image: -moz-linear-gradient(#fefefe, #e7e7e7);
  background-image: -webkit-linear-gradient(#fefefe, #e7e7e7);
  background-image: linear-gradient(#fefefe, #e7e7e7);
  background-repeat: repeat-x;
  border-radius: 2px;
  border: 1px solid #cfcfcf;
  color: #000;
  padding: 3px 5px;
  line-height: 10px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  display: inline-block;
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body .headerlink {
  font: normal 400 16px fontawesome-mini;
  vertical-align: middle;
  margin-left: -16px;
  float: left;
  display: inline-block;
  text-decoration: none;
  opacity: 0;
  color: #333;
}

.markdown-body .headerlink:focus {
  outline: none;
}

.markdown-body h1 .headerlink {
  margin-top: 0.8rem;
}

.markdown-body h2 .headerlink,
.markdown-body h3 .headerlink {
  margin-top: 0.6rem;
}

.markdown-body h4 .headerlink {
  margin-top: 0.2rem;
}

.markdown-body h5 .headerlink,
.markdown-body h6 .headerlink {
  margin-top: 0;
}

.markdown-body .headerlink:hover,
.markdown-body h1:hover .headerlink,
.markdown-body h2:hover .headerlink,
.markdown-body h3:hover .headerlink,
.markdown-body h4:hover .headerlink,
.markdown-body h5:hover .headerlink,
.markdown-body h6:hover .headerlink {
  opacity: 1;
  text-decoration: none;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre,
.markdown-body .admonition {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body code,
.markdown-body samp {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .codehilite {
  margin-bottom: 16px;
}

.markdown-body .codehilite pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .codehilite pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

/* Admonition */
.markdown-body .admonition {
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  position: relative;
  border-radius: 3px;
  border: 1px solid #e0e0e0;
  border-left: 6px solid #333;
  padding: 10px 10px 10px 30px;
}

.markdown-body .admonition table {
  color: #333;
}

.markdown-body .admonition p {
  padding: 0;
}

.markdown-body .admonition-title {
  font-weight: bold;
  margin: 0;
}

.markdown-body .admonition>.admonition-title {
  color: #333;
}

.markdown-body .attention>.admonition-title {
  color: #a6d796;
}

.markdown-body .caution>.admonition-title {
  color: #d7a796;
}

.markdown-body .hint>.admonition-title {
  color: #96c6d7;
}

.markdown-body .danger>.admonition-title {
  color: #c25f77;
}

.markdown-body .question>.admonition-title {
  color: #96a6d7;
}

.markdown-body .note>.admonition-title {
  color: #d7c896;
}

.markdown-body .admonition:before,
.markdown-body .attention:before,
.markdown-body .caution:before,
.markdown-body .hint:before,
.markdown-body .danger:before,
.markdown-body .question:before,
.markdown-body .note:before {
  font: normal normal 16px fontawesome-mini;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  line-height: 1.5;
  color: #333;
  position: absolute;
  left: 0;
  top: 0;
  padding-top: 10px;
  padding-left: 10px;
}

.markdown-body .admonition:before {
  content: "\f056\00a0";
  color: 333;
}

.markdown-body .attention:before {
  content: "\f058\00a0";
  color: #a6d796;
}

.markdown-body .caution:before {
  content: "\f06a\00a0";
  color: #d7a796;
}

.markdown-body .hint:before {
  content: "\f05a\00a0";
  color: #96c6d7;
}

.markdown-body .danger:before {
  content: "\f057\00a0";
  color: #c25f77;
}

.markdown-body .question:before {
  content: "\f059\00a0";
  color: #96a6d7;
}

.markdown-body .note:before {
  content: "\f040\00a0";
  color: #d7c896;
}

.markdown-body .admonition::after {
  content: normal;
}

.markdown-body .attention {
  border-left: 6px solid #a6d796;
}

.markdown-body .caution {
  border-left: 6px solid #d7a796;
}

.markdown-body .hint {
  border-left: 6px solid #96c6d7;
}

.markdown-body .danger {
  border-left: 6px solid #c25f77;
}

.markdown-body .question {
  border-left: 6px solid #96a6d7;
}

.markdown-body .note {
  border-left: 6px solid #d7c896;
}

.markdown-body .admonition>*:first-child {
  margin-top: 0 !important;
}

.markdown-body .admonition>*:last-child {
  margin-bottom: 0 !important;
}

/* progress bar*/
.markdown-body .progress {
  display: block;
  width: 300px;
  margin: 10px 0;
  height: 24px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #ededed;
  position: relative;
  box-shadow: inset -1px 1px 3px rgba(0, 0, 0, .1);
}

.markdown-body .progress-label {
  position: absolute;
  text-align: center;
  font-weight: bold;
  width: 100%; margin: 0;
  line-height: 24px;
  color: #333;
  text-shadow: 1px 1px 0 #fefefe, -1px -1px 0 #fefefe, -1px 1px 0 #fefefe, 1px -1px 0 #fefefe, 0 1px 0 #fefefe, 0 -1px 0 #fefefe, 1px 0 0 #fefefe, -1px 0 0 #fefefe, 1px 1px 2px #000;
  -webkit-font-smoothing: antialiased !important;
  white-space: nowrap;
  overflow: hidden;
}

.markdown-body .progress-bar {
  height: 24px;
  float: left;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #96c6d7;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .5), inset 0 -1px 0 rgba(0, 0, 0, .1);
  background-size: 30px 30px;
  background-image: -webkit-linear-gradient(
    135deg, rgba(255, 255, 255, .4) 27%,
    transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%,
    transparent 77%, transparent
  );
  background-image: -moz-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -ms-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -o-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
}

.markdown-body .progress-100plus .progress-bar {
  background-color: #a6d796;
}

.markdown-body .progress-80plus .progress-bar {
  background-color: #c6d796;
}

.markdown-body .progress-60plus .progress-bar {
  background-color: #d7c896;
}

.markdown-body .progress-40plus .progress-bar {
  background-color: #d7a796;
}

.markdown-body .progress-20plus .progress-bar {
  background-color: #d796a6;
}

.markdown-body .progress-0plus .progress-bar {
  background-color: #c25f77;
}

.markdown-body .candystripe-animate .progress-bar{
  -webkit-animation: animate-stripes 3s linear infinite;
  -moz-animation: animate-stripes 3s linear infinite;
  animation: animate-stripes 3s linear infinite;
}

@-webkit-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@-moz-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

.markdown-body .gloss .progress-bar {
  box-shadow:
    inset 0 4px 12px rgba(255, 255, 255, .7),
    inset 0 -12px 0 rgba(0, 0, 0, .05);
}

/* MultiMarkdown Critic Blocks */
.markdown-body .critic_mark {
  background: #ff0;
}

.markdown-body .critic_delete {
  color: #c82829;
  text-decoration: line-through;
}

.markdown-body .critic_insert {
  color: #718c00 ;
  text-decoration: underline;
}

.markdown-body .critic_comment {
  color: #8e908c;
  font-style: italic;
}

.markdown-body .headeranchor {
  font: normal normal 16px fontawesome-mini;
  line-height: 1;
  display: inline-block;
  text-decoration: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.headeranchor:before {
  content: '\e157';
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 4px 0.25em -20px;
  vertical-align: middle;
}

/* Media */
@media only screen and (min-width: 480px) {
  .markdown-body {
    font-size:14px;
  }
}

@media only screen and (min-width: 768px) {
  .markdown-body {
    font-size:16px;
  }
}

@media print {
  .markdown-body * {
    background: transparent !important;
    color: black !important;
    filter:none !important;
    -ms-filter: none !important;
  }

  .markdown-body {
    font-size:12pt;
    max-width:100%;
    outline:none;
    border: 0;
  }

  .markdown-body a,
  .markdown-body a:visited {
    text-decoration: underline;
  }

  .markdown-body .headeranchor-link {
    display: none;
  }

  .markdown-body a[href]:after {
    content: " (" attr(href) ")";
  }

  .markdown-body abbr[title]:after {
    content: " (" attr(title) ")";
  }

  .markdown-body .ir a:after,
  .markdown-body a[href^="javascript:"]:after,
  .markdown-body a[href^="#"]:after {
    content: "";
  }

  .markdown-body pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .markdown-body pre,
  .markdown-body blockquote {
    border: 1px solid #999;
    padding-right: 1em;
    page-break-inside: avoid;
  }

  .markdown-body .progress,
  .markdown-body .progress-bar {
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
  }

  .markdown-body .progress {
    border: 1px solid #ddd;
  }

  .markdown-body .progress-bar {
    height: 22px;
    border-right: 1px solid #ddd;
  }

  .markdown-body tr,
  .markdown-body img {
    page-break-inside: avoid;
  }

  .markdown-body img {
    max-width: 100% !important;
  }

  .markdown-body p,
  .markdown-body h2,
  .markdown-body h3 {
    orphans: 3;
    widows: 3;
  }

  .markdown-body h2,
  .markdown-body h3 {
    page-break-after: avoid;
  }
}
</style><style>/*GitHub*/
.codehilite {background-color:#fff;color:#333333;}
.codehilite .hll {background-color:#ffffcc;}
.codehilite .c{color:#999988;font-style:italic}
.codehilite .err{color:#a61717;background-color:#e3d2d2}
.codehilite .k{font-weight:bold}
.codehilite .o{font-weight:bold}
.codehilite .cm{color:#999988;font-style:italic}
.codehilite .cp{color:#999999;font-weight:bold}
.codehilite .c1{color:#999988;font-style:italic}
.codehilite .cs{color:#999999;font-weight:bold;font-style:italic}
.codehilite .gd{color:#000000;background-color:#ffdddd}
.codehilite .ge{font-style:italic}
.codehilite .gr{color:#aa0000}
.codehilite .gh{color:#999999}
.codehilite .gi{color:#000000;background-color:#ddffdd}
.codehilite .go{color:#888888}
.codehilite .gp{color:#555555}
.codehilite .gs{font-weight:bold}
.codehilite .gu{color:#800080;font-weight:bold}
.codehilite .gt{color:#aa0000}
.codehilite .kc{font-weight:bold}
.codehilite .kd{font-weight:bold}
.codehilite .kn{font-weight:bold}
.codehilite .kp{font-weight:bold}
.codehilite .kr{font-weight:bold}
.codehilite .kt{color:#445588;font-weight:bold}
.codehilite .m{color:#009999}
.codehilite .s{color:#dd1144}
.codehilite .n{color:#333333}
.codehilite .na{color:teal}
.codehilite .nb{color:#0086b3}
.codehilite .nc{color:#445588;font-weight:bold}
.codehilite .no{color:teal}
.codehilite .ni{color:purple}
.codehilite .ne{color:#990000;font-weight:bold}
.codehilite .nf{color:#990000;font-weight:bold}
.codehilite .nn{color:#555555}
.codehilite .nt{color:navy}
.codehilite .nv{color:teal}
.codehilite .ow{font-weight:bold}
.codehilite .w{color:#bbbbbb}
.codehilite .mf{color:#009999}
.codehilite .mh{color:#009999}
.codehilite .mi{color:#009999}
.codehilite .mo{color:#009999}
.codehilite .sb{color:#dd1144}
.codehilite .sc{color:#dd1144}
.codehilite .sd{color:#dd1144}
.codehilite .s2{color:#dd1144}
.codehilite .se{color:#dd1144}
.codehilite .sh{color:#dd1144}
.codehilite .si{color:#dd1144}
.codehilite .sx{color:#dd1144}
.codehilite .sr{color:#009926}
.codehilite .s1{color:#dd1144}
.codehilite .ss{color:#990073}
.codehilite .bp{color:#999999}
.codehilite .vc{color:teal}
.codehilite .vg{color:teal}
.codehilite .vi{color:teal}
.codehilite .il{color:#009999}
.codehilite .gc{color:#999;background-color:#EAF2F5}
</style><title>mytex</title></head><body><article class="markdown-body"><p>\documentclass[UTF8]{ctexart}</p>
<p>\usepackage[hidelinks]{hyperref}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{float}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{latexsym}</p>
<p>\usepackage{xcolor}     %高亮使用的颜色
\definecolor{commentcolor}{RGB}{85,139,78}
\definecolor{stringcolor}{RGB}{206,145,108}
\definecolor{keywordcolor}{RGB}{34,34,250}
\definecolor{backcolor}{RGB}{220,220,220}</p>
<p>\usepackage{accsupp}  <br />
\newcommand{\emptyaccsupp}[1]{\BeginAccSupp{ActualText={}}#1\EndAccSupp{}}</p>
<p>\usepackage{listings}
\lstset{                        %高亮代码设置
    language=python,                    %Python语法高亮
    linewidth=1.3\linewidth,            %列表list宽度
    %basicstyle=\ttfamily,              %tt无法显示空格
    commentstyle=\color{commentcolor},  %注释颜色
    keywordstyle=\color{keywordcolor},  %关键词颜色
    stringstyle=\color{stringcolor},    %字符串颜色
    %showspaces=true,                   %显示空格
    %numbers=left,                       %行数显示在左侧
    %numberstyle=\tiny\emptyaccsupp,     %行数数字格式
    %numbersep=5pt,                      %数字间隔
    frame=single,                       %加框
    framerule=0.1pt,                      %不划线
    escapeinside=@@,                    %逃逸标志
    emptylines=1,                       %
    xleftmargin=0.2em,                    %list左边距
    %backgroundcolor=\color{backcolor},  %列表背景色
    tabsize=4,                          %制表符长度为4个字符
    gobble=4                            %忽略每行代码前4个字符
    }
\begin{document}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{sddx.png}</p>
<p>\end{figure}</p>
<p>\begin{center}
\Huge  数值计算实验报告\
\large
~\
~\
~\
~\
~\
~\
赵晓辉 \quad 2017级数据班 \quad 201700150139  \
指导教师：刘保东教授
\end{center}
\thispagestyle{empty}
\newpage</p>
<p>\tableofcontents
\thispagestyle{empty}
\newpage
\setcounter{page}{1}
\pagestyle{empty} 
\section*{Summary}%摘要
数值计算指有效使用数字计算机求数学问题近似解的方法与过程，以及由相关理论构成的学科。主要研究如何用计算机能够更好的解决数学问题。</p>
<p>在数值计算的课程实验中，我们使用 PYTHON 对数学领域的常用算法进行了学习和编程实现，并进行了误差分析。内容包括线性方程组的求解、插值与拟合、微分与积分等内容，编写了若干经典算法，对课堂上讲的内容有了更深刻的理解。</p>
<p>进行完实验的学习之后，我们对计算机和数学之间的联系理解的更加透彻，为以后的科研之路打下了良好的基础。</p>
<p>本实验报告由latex编写，其中所有代码开源于</p>
<p>\href{<a href="https://github.com/zxh991103/NumericalCalculation/}{https://github.com/zxh991103/NumericalCalculation/">https://github.com/zxh991103/NumericalCalculation/}{https://github.com/zxh991103/NumericalCalculation/</a>}</p>
<p>\newpage</p>
<p>\section{第一章误差理论}</p>
<p>\subsection{problem 1}
根据以下方法构造算法和 MATLAB 程序，以便精确计算所有情况下的二次方程的根，包括$|b| \approx \sqrt {b^2-4ac} $的情况。</p>
<p>设$ a \not= 0 ,b^2-4ac &gt; 0 $且有方程$ ax^2+bx+c=0$</p>
<p>\begin{equation}
\begin{array}{rcl}
x_1=\frac{-b+\sqrt{b^2-4ac}}{2a} , x_2=\frac{-b-\sqrt{b^2-4ac}}{2a}&amp; &amp; { }\
\end{array}
\end{equation}</p>
<p>公式(1)(2)等价于下列公式</p>
<p>\begin{equation}
\begin{array}{rcl}
x_1=\frac{-2c}{b+\sqrt{b^2-4ac}} , x_2=\frac{-2c}{b-\sqrt{b^2-4ac}}&amp; &amp; { }\
\end{array}
\end{equation}</p>
<p>当$b&gt;0$的时候使用公式(1)计算$ x_1$ ,使用公式(2)计算$ x_2$。</p>
<p>当$b&lt;0$的时候使用公式(1)计算$ x_2$ ,使用公式(2)计算$ x_1$。</p>
<p>求解方程如下：</p>
<p>(a)$ x^2-1000.001x+1=0$</p>
<p>(b)$ x^2-10000.0001x+1=0$</p>
<p>(c)$ x^2-100000.00001x+1=0$</p>
<p>(d)$ x^2-1000000.000001x+1=0$</p>
<p>结果如下：</p>
<p>(a)$ x_1=1000.0000000236469 , x_2=0.0009999999999763531$</p>
<p>(b)$ x_1=9999.999979772838 , x_2=0.00010000000020227162$</p>
<p>(c)$ x_1=99999.96614643588 , x_2=1.0000003385357559\times 10^{-5}$</p>
<p>(d)$ x_1=999992.38556461 , x_2=1.00000761449337\times 10^{-6}$                                      </p>
<p>由于计算机的发展和精确度的提高，使用题目中的方法的python实现和普通的二次求根公式进行计算的结果相差不大。</p>
<p>python实现代码如下：
\begin{lstlisting}</p>
<div class="codehilite"><pre>def f_11(a, b, c):
t = pow(b * b - 4 * a * c, 0.5)
x1 = (-b + t) / (2 * a)
return x1

def f_12(a, b, c):
    t = pow(b * b - 4 * a * c, 0.5)
    x2 = (-b - t) / (2 * a)
    return x2


def f_21(a, b, c):
    t = pow(b * b - 4 * a * c, 0.5)
    x1 = (-2 * c) / (b + t)
    return x1

def f_22(a, b, c):
    t = pow(b * b - 4 * a * c, 0.5)
    x2 = (-2 * c) / (b - t)
    return x2



l = [[1, -1000.001, 1],
     [1, -10000.0001, 1],
     [1, -100000.00001, 1],
     [1, -1000000.000001, 1]]

for k in l:
    if k[1]&lt;0:
        print(f_21(k[0],k[1],k[2]),f_12(k[0],k[1],k[2]))
    else:
        print(f_11(k[0], k[1], k[2]), f_22(k[0], k[1], k[2]))
</pre></div>


<p>\end{lstlisting}</p>
<p>\subsection{problem 2}
对下列 3 个差分方程计算出前十个数值近似值。在每种情况下引入一个小的初始误差。如果没有初始误差，则每个差分方程将生成序列${ (\frac{1}{2})_{n=1}^{\infty} }$ 。</p>
<p>构造误差表和误差图。</p>
<p>(a)$r_0=0.994,r_n=\frac{1}{2} r_{n-1}$,其中$n=1,2, \cdots$</p>
<p>(b)$p_0=1,p_1=0.497,p_n=\frac{3}{2} p_{n-1} - \frac{1}{2} p_{n-2}$,其中$n=2,3, \cdots$</p>
<p>(c)$q_0=1,q_1=0.497,q_n=\frac{5}{2} q_{n-1} - q_{n-2}$,其中$n=2,3, \cdots$</p>
<p>利用如下python代码根据题目中的公式进行迭代。
\begin{lstlisting}</p>
<div class="codehilite"><pre>import numpy as np
r=[0.994]
p=[1,0.497]
q=[1,0.497]
x=[1]
for i in range(20):
    t=0.5*r[i]
    r.append(t)
    t=1.5*p[i+1]-0.5*p[i]
    p.append(t)
    t=2.5*q[i+1]-0.5*q[i]
    q.append(t)
    t=0.5*x[i]
    x.append(t)
print(q[2])
x=x[0:11]
r=r[0:11]
p=p[0:11]
q=q[0:11]

x_r_p_q=np.array([x,r,p,q]).T

print(x_r_p_q)


t=[i for i in range(11)]

x_r=[(i[0]-i[1]) for i in x_r_p_q]
x_p=[(i[0]-i[2]) for i in x_r_p_q]
x_q=[-(i[0]-i[3]) for i in x_r_p_q]

import matplotlib.pyplot as plt

plt.plot(t,x_r)
plt.scatter(t,x_r)
plt.show()

plt.plot(t,x_p)
plt.scatter(t,x_p)
plt.show()

plt.plot(t,x_q)
plt.scatter(t,x_q)
plt.show()
</pre></div>


<p>\end{lstlisting}</p>
<p>得到$ r_n $、$ p_n$ 、$ q_n $结果数值如下:</p>
<p>\begin{table}[H]
\caption{x、r、p、q数值表}
\begin{tabular}{|l|l|l|l|l|}
\hline</p>
<p>n &amp; x &amp; r &amp; p &amp; q \ \hline
0 &amp; 1 &amp; 0.994 &amp; 1 &amp; 1 \ \hline
1 &amp; 0.5 &amp; 0.497 &amp; 0.497 &amp; 0.497 \ \hline
2 &amp; 0.25 &amp; 0.2485 &amp; 0.2455 &amp; 0.7425 \ \hline
3 &amp; 0.125 &amp; 0.12425 &amp; 0.11975 &amp; 1.60775 \ \hline
4 &amp; 0.0625 &amp; 0.062125 &amp; 0.056875 &amp; 3.648125 \ \hline
5 &amp; 0.03125 &amp; 0.0310625 &amp; 0.0254375 &amp; 8.3164375 \ \hline
6 &amp; 0.015625 &amp; 0.01553125 &amp; 0.00971875 &amp; 18.96703125 \ \hline
7 &amp; 0.0078125 &amp; 0.007765625 &amp; 0.001859375 &amp; 43.25935937 \ \hline
8 &amp; 0.00390625 &amp; 0.003882813 &amp; -0.002070312 &amp; 98.66488281 \ \hline
9 &amp; 0.001953125 &amp; 0.001941406 &amp; -0.004035156 &amp; 225.0325273 \ \hline
10 &amp; 0.000976563 &amp; 0.000970703 &amp; -0.005017578 &amp; 513.248877 \ \hline</p>
<p>\end{tabular}
\end{table}</p>
<p>\begin{table}[H]</p>
<p>\caption{差值表}
\begin{tabular}{|l|l|l|l|}
\hline</p>
<p>n &amp; x-r &amp; x-p &amp; x-q \ \hline
0 &amp; 0.006 &amp; 0 &amp; 0 \ \hline
1 &amp; 0.003 &amp; 0.003 &amp; -0.003 \ \hline
2 &amp; 0.0015 &amp; 0.0045 &amp; 0.4925 \ \hline
3 &amp; 0.00075 &amp; 0.00525 &amp; 1.48275 \ \hline
4 &amp; 0.000375 &amp; 0.005625 &amp; 3.585625 \ \hline
5 &amp; 0.0001875 &amp; 0.0058125 &amp; 8.2851875 \ \hline
6 &amp; 0.00009375 &amp; 0.00590625 &amp; 18.95140625 \ \hline
7 &amp; 0.000046875 &amp; 0.005953125 &amp; 43.25154687 \ \hline
8 &amp; 0.0000234375 &amp; 0.005976562 &amp; 98.66097656 \ \hline
9 &amp; 0.00001171875 &amp; 0.005988281 &amp; 225.0305742 \ \hline
10 &amp; 0.000005859375 &amp; 0.005994141 &amp; 513.2479004 \ \hline</p>
<p>\end{tabular}
\end{table}</p>
<p>误差$ x_n-r_n$、$ x_n-p_n$、$ x_n-q_n$的分布图如下：</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{1-2-1.png}
  \caption{xn-rn误差变化图}
\end{figure}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{1-2-2.png}
  \caption{xn-pn误差变化图}
\end{figure}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{1-2-3.png}
  \caption{xn-qn误差变化图}
\end{figure}
\newpage
\subsection{作业}
~\
2.完成下列计算：</p>
<p>$ \int_{0}^{1 / 4} e^{x^{2}} d x  \approx \int_{0}^{1 / 4}\left(1+x^{2}+\frac{x^{4}}{3}+\frac{x^{6}}{3 !}\right) d x = \hat{p}$</p>
<p>指出在这种情况下会出现哪种类型的误差，并将计算结果与真实值p=0.2553074606进行比较。</p>
<p>$\begin{aligned} \int_{0}^{1 / 4} e^{x^{2}} d x &amp; \approx \int_{0}^{1 / 4}\left(1+x^{2}+\frac{x^{4}}{2！}+\frac{x^{6}}{3 !}\right) d x \ 
&amp;=\left(x+\frac{x^{3}}{3}+\frac{x^{5}}{5(2 !)}+\frac{x^{7}}{7(3 !)}\right)_{x=0}^{x=1 / 4} \ 
&amp;=\frac{1}{4}+\frac{1}{19^{2}}+\frac{1}{10240}+\frac{x^{2}}{688128} \ 
&amp;=\frac{292807}{1146880} \approx 0.255307428=\hat{p} 
\end{aligned}$</p>
<p>$ | \hat{p}-p |=3.2599999977289684 \times 10^{-8}$</p>
<p>误差分为2个部分：</p>
<p>\quad1.使用泰勒公式余项带来的误差。</p>
<p>\quad2.浮点数运算带来的误差</p>
<p>~\ 
~\
~\</p>
<p>5.有时利用三角或代数恒等式，重新排列函数中的项，可以避免精度损失。求下列函数的等价公式，以避免精度损失。</p>
<p>(a)ln(x+1)-ln(x),其中x较大。</p>
<p>(b)$ \sqrt{x^2+1} - x$,其中x较大。</p>
<p>(c)$ cos^2 (x) - sin^2 (x)$,其中x$\approx \frac{\pi}{4}$ </p>
<p>(d)$ \sqrt{\frac{1+cos(x)}{2}} $,其中x$\approx \pi$ </p>
<p>answer:</p>
<p>\quad (a)ln(x+1)-ln(x)=ln $ \frac{x+1}{x}$</p>
<p>\quad (b)$ \sqrt{x^2+1} - x = \frac{1}{\sqrt{x^2+1}+x}  $</p>
<p>\quad (c)$ cos^2 (x) - sin^2 (x) = cos (2x)$</p>
<p>\quad (d)$ \sqrt{\frac{1+cos(x)}{2}} = \sqrt{1+2cos^2 \frac{x}{2} -1}{2}  = cos(\frac{x}{2})$</p>
<p>~\ 
~\
~\</p>
<p>8.讨论下列计算过程中的误差传播</p>
<p>(a)三个数的和：</p>
<p>\quad \quad p+q+r=$(\hat{p}+\epsilon_{p})+(\hat{q}+\epsilon_{q})+(\hat{r}+\epsilon_{r}) $</p>
<p>(b)两个数的商：$ \frac{p}{q} = \frac{\hat{p}+\epsilon_{p}}{\hat{q}+\epsilon_{q}}$</p>
<p>(c)三个数的积：</p>
<p>\quad \quad pqr=$(\hat{p}+\epsilon_{p})(\hat{q}+\epsilon_{q})(\hat{r}+\epsilon_{r}) $</p>
<p>answer:</p>
<p>(a)误差传播为:</p>
<p>$ (p+q+r)-(\hat{p}+\hat{q}+\hat{r}) $~\
 \quad$=(\hat{p}+\epsilon_{p})+(\hat{q}+\epsilon_{q})+(\hat{r}+\epsilon_{r})-(\hat{p}+\hat{q}+\hat{r})$~\ 
\quad$=\epsilon_{p}+\epsilon_{q}+\epsilon_{r} $</p>
<p>(b)误差传播为：</p>
<p>$ (\frac{p}{q})-(\frac{\hat{p}}{\hat{q}}) $~\
 \quad$= (\frac{\hat{p}+\epsilon_{p}}{\hat{q}+\epsilon_{q}})-(\frac{\hat{p}}{\hat{q}})$~\ 
\quad$=\frac{\hat{p}}{\hat{q}} + \frac{\epsilon_{p} - \frac{p}{q}\epsilon_{q} }{q+\epsilon_{p}} -(\frac{\hat{p}}{\hat{q}})$~\
\quad $ = \frac{\epsilon_{p} - \frac{p}{q}\epsilon_{q} }{q+\epsilon_{p}}$</p>
<p>当$ 1&lt;|\hat{q}|&lt;|\hat{p}|$时，误差较大。</p>
<p>(c)误差传播为：</p>
<p>$\begin{aligned} p q r=&amp;\left(\hat{p}+\epsilon_{p}\right)\left(\hat{q}+\epsilon_{q}\right)\left(\hat{r}+\epsilon_{r}\right) \=&amp; \hat{p} \hat{q} \hat{r}+\hat{p} \hat{r} \epsilon_{q}+\hat{q} \hat{r} \epsilon_{p}+\hat{p} \hat{q} \epsilon_{r}+\hat{r} \epsilon_{p} \epsilon_{q}+\hat{q} \epsilon_{p} \epsilon_{r}+\hat{p} \epsilon_{q} \epsilon_{r}+\epsilon_{p} \epsilon_{q} \epsilon_{r} \=&amp; \hat{p} \hat{q} \hat{r}+\left(\hat{p} \hat{r} \epsilon_{q}+\hat{q} \hat{r} \epsilon_{p}+\hat{p} \hat{q} \epsilon_{r}\right) \ &amp;+\left(\hat{r} \epsilon_{p} \epsilon_{q}+\hat{q} \epsilon_{p} \epsilon_{r}+\hat{p} \epsilon_{q} \epsilon_{r}\right)+\epsilon_{p} \epsilon_{q} \epsilon_{r} \end{aligned}$</p>
<p>若$ \hat{q}.\hat{p}.\hat{r}$ 的绝对值较大，误差较大</p>
<p>~\
~\
~\</p>
<p>11.设有泰勒展开式：</p>
<p>\quad \quad $ cos(h)=1-\frac{h^2}{2!} + \frac{h^4}{4!} +  \boldsymbol{O} (h^5)$</p>
<p>和</p>
<p>\quad \quad $ sin(h)=h-\frac{h^3}{3!} + \frac{h^5}{5!} +  \boldsymbol{O} (h^7)$</p>
<p>判定它们的和与积的近似阶。</p>
<p>answer:</p>
<p>$\begin{aligned} \cos (h)+\sin (h) &amp;=1+h-\frac{h^{2}}{2}-\frac{h^{3}}{6}+\frac{h^{4}}{24}+\boldsymbol{O}\left(h^{5}\right) \ \cos (h) \sin (h) &amp;=h-\frac{2 h^{3}}{3}+\frac{2 h^{5}}{15}+\boldsymbol{O}\left(h^{7}\right) \end{aligned}$</p>
<p>$1. cos(h)\times sin(h)=\frac{1}{2} sin(2h) $</p>
<p>$2. \left(1-\frac{h^{2}}{2}+\frac{h^{4}}{24}\right)\left(h-\frac{h^{3}}{6}+\frac{h^{5}}{120}\right)=h-\frac{2 h^{3}}{3}+\frac{2 h^{5}}{15}-\frac{h^{7}}{90}+\frac{h^{9}}{2880}$</p>
<p>\newpage
\section{第二章非线性方程求根}</p>
<p>\subsection{problem 1}</p>
<p>求方程$2 x^{2}+x-15=0$的正根近似值，分别利用如下三种格式编程计算：</p>
<p>(a)
$x_{k+1}=15-x_{k}^{2}, k=0,1,2, \cdots$取初始值$ x_0 =2$</p>
<p>(b)
$ x_{k+1}=\frac{15}{2 x_{k+1}}, k=0,1,2, \cdots$取初始值$ x_0 =2$</p>
<p>(c)
$ x_{k+1}=x_{k}-\frac{2 x_{k}^{2}+x_{k}-15}{4 x_{k}+1}, k=0,1,2, \cdots$取初始值$ x_0 =2$</p>
<p>依次计算$x_{1}, x_{2}, \cdots, x_{k}, \cdots$并作图观察解的稳定性、收敛性，并分析其原因。</p>
<p>\subsubsection{problem 1.1}</p>
<p>(a)python实现代码如下：</p>
<p>\begin{lstlisting}
    import numpy as np
    import matplotlib.pyplot as plt
    N=4</p>
<div class="codehilite"><pre>l1=[2]
for i in range(1,N):
    l1.append(15-pow(l1[i-1],2))

l2=[]
for i in range(N):
    l2.append(i)

x=np.asanyarray(l2)
y=np.asanyarray(l1)

plt.scatter(x, y)
plt.show()
</pre></div>


<p>\end{lstlisting}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{2-1-1.png}
  \caption{xk图(a)}
\end{figure}</p>
<p>\subsubsection{problem 1.2}</p>
<p>(b)python实现代码如下：</p>
<p>\begin{lstlisting}</p>
<div class="codehilite"><pre>import numpy as np
import matplotlib.pyplot as plt
N=100


l1=[2]
for i in range(1,N):
    l1.append(15/(2*l1[i-1]+1))

l2=[]
for i in range(N):
    l2.append(i)

x=np.asanyarray(l2)
y=np.asanyarray(l1)

plt.scatter(x, y)
plt.show()
</pre></div>


<p>\end{lstlisting}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{2-1-2.png}
  \caption{xk图(b)}
\end{figure}</p>
<p>\subsubsection{problem 1.3}</p>
<p>(c)python实现代码如下：
\begin{lstlisting}</p>
<div class="codehilite"><pre>import numpy as np
import matplotlib.pyplot as plt
N=10


l1=[2]
for i in range(1,N):
    l1.append(l1[i-1] - (2*pow(l1[i-1],2)+l1[i-1]-15)/(4*l1[i-1]+1))

l2=[]
for i in range(N):
    l2.append(i)

x=np.asanyarray(l2)
y=np.asanyarray(l1)

plt.scatter(x, y)
plt.show()
</pre></div>


<p>\end{lstlisting}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{2-1-3.png}
  \caption{xk图(c)}
\end{figure}</p>
<p>\subsection{problem 2}
证明方程$2-3x-sin(x)=0 $在(0,1)内有且有一个实根，使用二分法求误差不大于0.0005的根，及其需要的得带次数。</p>
<p>python实现代码如下：</p>
<p>\begin{lstlisting}
    import math
    def f(x):
        return 2-3*x-math.sin(x)</p>
<div class="codehilite"><pre>print(&#39;prove:f(0)*f(1)=&#39;,f(0)*f(1),&#39;&lt;0&#39;)

x1=0
x2=1
i=0
while x2-x1&gt;0.000005:
    i+=1
    x=(x1+x2)/2
    if f(x)*f(x1)&lt;=0:
        x2=x
    else:
        x1=x

print(x1)
print(i)
</pre></div>


<p>\end{lstlisting}</p>
<p>证明：</p>
<p>\begin{math}
f(0) \cdot f(1)= -3.682941969615793 &lt;0\
f^{&lsquo;}\left( x\right) =-3-\cos x\
-\cos x\leq 1 \
f^{&lsquo;}\left( x\right)  &lt;0
\end{math}</p>
<p>f(x)单调递减</p>
<p>使用二分法误差不大于0.0005的根为$ 0.50530624389648440$</p>
<p>迭代次数$18$</p>
<p>\subsection{problem 3}</p>
<p>利用牛顿法求解方程：
$ \frac{1}{2}+\frac{1}{4} x^{2}-x \sin x-\frac{1}{2} \cos 2 x=0$
分别取$ x_{0}=\frac{\pi}{2}, 5 \pi, 10 \pi$ ,使得精度不超过$ 10^{-5}$比较初值对计算结果的影响
\begin{lstlisting}
    import math
    import numpy as np
    from sympy import *
    import matplotlib.pyplot as plt
    def f(x):
        return 0.5+0.25<em>pow(x,2)-x</em>math.sin(x)-0.5<em>math.cos(2</em>x)</p>
<div class="codehilite"><pre>delta = 0.01

def f_1(x):
    return (f(x+delta)-f(x))/delta

def f_2(x):
    return (f_1(x+delta)-f_1(x))/delta


def g(x):
    return x-f(x)/f_1(x)





def cal(x0):
    res=[0,x0]
    t1=0
    t2=x0
    while ( abs( t1-t2 ) &gt; pow(10,-5) ):
        t1=t2
        t2=g(res[len(res)-1])
        res.append(t2)
    return res


x0=math.pi/2
x1=math.pi*5
x2=math.pi*10

r0=cal(x0)
r1=cal(x1)
r2=cal(x2)

y0=[]
y1=[]
y2=[]

for i in range(len(r0)):
    y0.append(i)

for i in range(len(r1)):
    y1.append(i)

for i in range(len(r2)):
    y2.append(i)

print(r0[-1],r1[-1],r2[-1])
x=np.asanyarray(y0)
y=np.asanyarray(r0)
plt.plot(x,y)
plt.scatter(x, y)
plt.savefig(&#39;2-3-0.png&#39;)
plt.show()
x=np.asanyarray(y1)
y=np.asanyarray(r1)
plt.plot(x,y)
plt.scatter(x, y)
plt.savefig(&#39;2-3-1.png&#39;)
plt.show()

x=np.asanyarray(y2)
y=np.asanyarray(r2)
plt.plot(x,y)
plt.scatter(x, y)
plt.savefig(&#39;2-3-2.png&#39;)
plt.show()
</pre></div>


<p>\end{lstlisting}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{2-3-0.png}
  \caption{x0图}
\end{figure}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{2-3-1.png}
  \caption{x1图}
\end{figure}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{2-3-2.png}
  \caption{x2图}
\end{figure}</p>
<p>收敛过程不同，最后分别收敛到1.8958096931257646，-1.8951889600105052，1.8958113494649107</p>
<p>\subsection{problem 4}
python实现代码如下：
\begin{lstlisting}</p>
<div class="codehilite"><pre>import math

def f(x):
    return 5*x-math.exp(x)
</pre></div>


<p>\end{lstlisting}
\begin{lstlisting}%&rsquo;二分结果:&rsquo;,</p>
<div class="codehilite"><pre>x1=0
x2=1
while x2-x1&gt;0.0001:
    x=(x1+x2)/2
    if f(x)*f(x1)&lt;=0:
        x2=x
    else:
        x1=x

print((x1+x2)/2)
</pre></div>


<p>\end{lstlisting}
\begin{lstlisting}%&rsquo;牛顿法:&rsquo;,</p>
<div class="codehilite"><pre>delta = 0.000001

def f_1(x):
    return (f(x+delta)-f(x))/delta
def g(x):
    return x-f(x)/f_1(x)

def cal(x0):
    res=[0,x0]
    t1=0
    t2=x0
    while ( abs( t1-t2 ) &gt; pow(10,-4) ):
        t1=t2
        t2=g(res[len(res)-1])
        res.append(t2)
    return res

res=cal(1)
print(res[-1])
</pre></div>


<p>\end{lstlisting}
\begin{lstlisting}%&rsquo;割线法:&rsquo;,</p>
<div class="codehilite"><pre>def cut():
    t1=0
    t2=0.1
    res=[t1,t2]
    while abs(t2-t1) &gt; pow(10,-4):
        temp=t2
        t2= t2-( f(t2)*(t2-t1) )/( f(t2) - f(t1) )
        t1=temp
        res.append(t2)

    return res

res1=cut()

print(res1[-1])
</pre></div>


<p>\end{lstlisting}
\begin{lstlisting}%&rsquo;错位法:&rsquo;,</p>
<div class="codehilite"><pre>def dislocation():
    t1 = 0
    t2 = 0.3

    while abs(t2-t1) &gt; 0.0001:
        t = t2 - (f(t2)*(t2-t1))/(f(t2)-f(t1))
        if f(t) * f(t1) &lt;= 0:
            t2 = t
        else:
            t1 = t
        # print((t1+t2)/2)
    return (t1+t2)/2

print(dislocation())
</pre></div>


<p>\end{lstlisting}
二分结果: 0.259185791015625</p>
<p>牛顿法: 0.25917110178446734</p>
<p>割线法: 0.2591711018149536</p>
<p>错位法: 0.25917110181907377
\newpage
\section{第六、七章线性方程组求解}
求解线性方程组</p>
<p>\begin{math} 
\
4 x-y+z =7 \ 
4 x-8 y+z =-21 \
-2 x+y+5 z =15 
\end{math}
\subsection{problem 1}
LU分解求解的python代码实现
\begin{lstlisting}</p>
<div class="codehilite"><pre>import numpy as np
import math
import scipy as scipy
from scipy import linalg

x = [[4, -1, 1],
     [4, -8, 1],
     [-2, 1, 5]]

y = [7, -21, 15]


X = np.array(x)
Y = np.array(y)
n = 3

l, u = scipy.linalg.lu(X, True)

y0 = [0, 0, 0]
sum = 0
for i in range(n):
    t = 0
    for j in range(sum):
        t += y0[j] * l[i][j]
    y0[i] = (Y[i] - t) / l[i][sum]
    sum += 1

y1 = [0, 0, 0]
sum = 0
for i in range(n):
    t = 0
    for j in range(sum):
        t += y1[n - j - 1] * u[n - i - 1][n - j - 1]
    y1[n - i - 1] = (y0[n - i - 1] - t) / u[n - i - 1][n - sum - 1]
    sum += 1

print(y1)
</pre></div>


<p>\end{lstlisting}</p>
<p>求解结果为：
x=2，y=4，z=3
\subsection{problem 2}
Jacobi，Gauss-Seidel求解的python代码实现
\begin{lstlisting}</p>
<div class="codehilite"><pre>#Jacobi
x = [[4, -1, 1],
     [4, -8, 1],
     [-2, 1, 5]]

y = [7, -21, 15]

X = np.array(x)
Y = np.array(y)
n = 3

xa=[[1,1,1]]
for i in range(1000):
    if xa[i]==[2,4,3]:
        break;
    tem=[]
    for j in range(n):
        t=0
        for k in range(n):
            if k!=j:
                t+=X[j][k]*xa[i][k]
        tem.append((Y[j]-t)/X[j][j])
    xa.append(tem)

print(xa[len(xa)-1])

#Gauss-Seidel
x = [[4, -1, 1],
     [4, -8, 1],
     [-2, 1, 5]]

y = [7, -21, 15]

X = np.array(x)
Y = np.array(y)
n = 3


xa=[[1,1,1]]
for i in range(1000):
    if xa[i]==[2,4,3]:
        break;
    tem=[]
    for j in range(n):
        t=0
        for k in range(len(tem)):
            if k!=j:
                t+=X[j][k]*tem[k]
        for k in range(len(tem),n):
            if k!=j:
                t+=X[j][k]*xa[i][k]

        tem.append((Y[j]-t)/X[j][j])
    xa.append(tem)

print(xa[len(xa)-1])
</pre></div>


<p>\end{lstlisting}
求解结果为：</p>
<p>Jacobi：
x=2，y=4，z=3</p>
<p>Gauss-Seidel：
x=2，y=4，z=3
\newpage
\section{第三章插值多项式}
\subsection{problem 1}
以$ y=sin(x)$ 为例，在$[0, \pi ] $ 区间内生成11个、21个数据点，用：</p>
<p>1.自然边界</p>
<p>2.固定边界</p>
<p>3.周期边界</p>
<p>4.强制第一个子区间和第二个子区间样条多项式的三阶导数相同，倒数第二个子区间和最后一个子区间的三次样条函数的三阶导数相等</p>
<p>4个边界条件，分别计算其样条插值，并作图比较，分析其差异性。</p>
<p>实现的python代码如下：</p>
<p>\begin{lstlisting}
    def cal(A, B):
        x = np.linalg.solve(A, B)
        return x</p>
<div class="codehilite"><pre>import numpy as np
import math


def ct(n):
    PI = math.pi
    de = PI / 100
    return de * n


x11 = [ct(0), ct(7), ct(20), ct(29), ct(32), ct(50), ct(64),
 ct(70), ct(82), ct(90), ct(100)]

x21 = [ct(0), ct(4), ct(10), ct(12), ct(14), ct(20), ct(23), ct(27), 
ct(35), ct(40), ct(43), ct(55), ct(61), ct(65),
       ct(70), ct(83),
       ct(87), ct(91), ct(94), ct(98), ct(100)]


def initial(x0=0.0, xn=math.pi, n=10, x=x11):
    y = []
    for i in range(n + 1):
        y.append(math.sin(x[i]))

    a = np.array(y)

    h = []
    for i in range(n):
        h.append(x[i + 1] - x[i])

    return a, h, y


def createAb(h, a, choice=0, n=10):
    if choice == 0:
        A = np.zeros((n + 1, n + 1))
        A[0][0] = 1
        A[n][n] = 1
        for i in range(1, n):
            A[i][i - 1] = h[i - 1]
            A[i][i] = 2 * (h[i - 1] + h[i])
            A[i][i + 1] = h[i]
        b = np.zeros(n + 1)
        for i in range(1, n):
            b[i] = 3 * (a[i + 1] - a[i]) / h[i] - 3 * (a[i] - a[i - 1]) 
            / h[i - 1]
        return A, b
    if choice == 1:
        A = np.zeros((n + 1, n + 1))
        A[0][0] = 2 * h[0]
        A[0][1] = h[0]
        A[n][n - 1] = 2 * h[n - 1]
        A[n][n] = h[n - 1]
        for i in range(1, n):
            A[i][i - 1] = h[i - 1]
            A[i][i] = 2 * (h[i - 1] + h[i])
            A[i][i + 1] = h[i]
        b = np.zeros(n + 1)
        for i in range(1, n):
            b[i] = 3 * (a[i + 1] - a[i]) / h[i] - 3 * (a[i] - a[i - 1])
             / h[i - 1]
        return A, b
    if choice == 2:
        A = np.zeros((n + 1, n + 1))
        A[0][0] = h[0] * 2 / 3
        A[0][1] = h[0] * 2
        A[0][n - 1] = h[n - 1] * 2 / 3
        A[0][n] = h[n - 1] / 3
        A[n][0] = 1
        A[n][n - 1] = -1
        for i in range(1, n):
            A[i][i - 1] = h[i - 1]
            A[i][i] = 2 * (h[i - 1] + h[i])
            A[i][i + 1] = h[i]
        b = np.zeros(n + 1)
        b[0] = (a[1] - a[0]) / h[0] - (a[n] - a[n - 1]) / h[n - 1]
        for i in range(1, n):
            b[i] = 3 * (a[i + 1] - a[i]) / h[i] - 3 * (a[i] - a[i - 1]) 
            / h[i - 1]
        return A, b
    if choice == 3:
        A = np.zeros((n + 1, n + 1))
        A[0][0] = 1
        A[0][1] = -1

        A[n][n] = 1
        A[n][n - 1] = -1
        for i in range(1, n):
            A[i][i - 1] = h[i - 1]
            A[i][i] = 2 * (h[i - 1] + h[i])
            A[i][i + 1] = h[i]
        b = np.zeros(n + 1)

        for i in range(1, n):
            b[i] = 3 * (a[i + 1] - a[i]) / h[i] - 3 * (a[i] - a[i - 1])
             / h[i - 1]
        return A, b


def calcd(a, c, h, n=10):
    b = np.zeros(n)
    d = np.zeros(n)
    for i in range(n):
        b[i] = (a[i + 1] - a[i]) / h[i] - h[i] * (c[i + 1] + 2 * c[i]) 
        / 3
        d[i] = (c[i + 1] - c[i]) / (3 * h[i])
    return b, d





from matplotlib import pyplot as plt
def everysection(a, b, c, d, x, i):
    xt = np.linspace(x[i], x[i + 1], 100)
    y = d[i] * (xt - x[i]) ** 3 + c[i] * (xt - x[i]) ** 2 + b[i] 
    * (xt - x[i]) + a[i]
    plt.plot(xt, y, color=&quot;green&quot;, linewidth=0.5)


def inplot():
    x = np.linspace(0, np.pi, 100, endpoint=True)
    y = np.sin(x)
    plt.plot(x, y,color=&#39;pink&#39;,linewidth=3)


def pAll(a, b, c, d, x, N):
    for i in range(N):
        everysection(a, b, c, d, x, i)
        print(i)
    plt.scatter(x, a, color=&#39;red&#39;, marker=&#39;o&#39;)
    plt.savefig(&#39;a.png&#39;)
    plt.show()



def run(N=10,X=x11,ch=2):
    a, h, y = initial(n=N, x=X)
    A, B = createAb(h, a, choice=ch, n=N)
    c = cal(A, B)
    b, d = calcd(a, c, h, N)
    print(len(a))
    print(len(b))
    print(len(c))
    print(len(d))
    inplot()
    pAll(a, b, c, d, x=X, N=N)



run(20,x21,0)
run(20,x21,1)
run(20,x21,2)
run(20,x21,3)
</pre></div>


<p>\end{lstlisting}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{4-0_11.png}
  \caption{11个数据点，自然边界}
\end{figure}
\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{4-1_11.png}
  \caption{11个数据点，固定边界}
\end{figure}
\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{4-2_11.png}
  \caption{11个数据点，周期边界}
\end{figure}
\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{4-3_11.png}
  \caption{11个数据点，强制边界}
\end{figure}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{4-0_21.png}
  \caption{21个数据点，自然边界}
\end{figure}
\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{4-1_21.png}
  \caption{21个数据点，固定边界}
\end{figure}
\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{4-2_21.png}
  \caption{21个数据点，周期边界}
\end{figure}
\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{4-3_21.png}
  \caption{21个数据点，强制边界}
\end{figure}
\newpage</p>
<p>\subsection{作业推导}</p>
<p>~\
~\</p>
<p>给定在[a,b]上定义的函数f和一组节点$a=x_{0}&lt;x_{1}&lt;\cdots&lt;x_{n}=b$ ,f的三次样条插值S是满足下列条件的函数：</p>
<p>a.S(x)在子区间$ [x_j,x_{j+1}(j=0,1,\cdots ,n-1) ]$上是三次多项式，记为$S_j(x)$</p>
<p>b.$S\left(x_{j}\right)=f\left(x_{j}\right)(j=0,1, \cdots, n)$</p>
<p>c.$S_{j+1}\left(x_{j+1}\right)=S_{j}\left(x_{j+1}\right)(j=0,1, \cdots, n-2)$</p>
<p>d.$S_{j+1}^{\prime}\left(x_{j+1}\right)=S_{j}^{\prime}\left(x_{j+1}\right)(j=0,1, \cdots, n-2)$</p>
<p>e.$S_{j+1}^{\prime \prime}\left(x_{j+1}\right)=S_{j}^{\prime \prime}\left(x_{j+1}\right)(j=0,1, \cdots, n-2)$</p>
<p>f.边界条件：</p>
<p>\quad (i) $S^{\prime \prime}\left(x_{0}\right)=\alpha_1$</p>
<p>\quad (ii)$S^{\prime \prime}\left(x_{0}\right)=\alpha_2$</p>
<p>\quad (iii)$
S^{\prime}\left(x_{0}\right)=\beta_1
$</p>
<p>\quad (iv)$
S^{\prime}\left(x_{0}\right)=\beta_2
$</p>
<p>为构造给定函数f的三次样条插值，把定义中的条件用到三次多项式：</p>
<p>$S_{j}(x)=a_{j}+b_{j}\left(x-x_{j}\right)+c_{j}\left(x-x_{j}\right)^{2}+d_{j}\left(x-x_{j}\right)^{3}, \quad j=0,1, \cdots, n-1$</p>
<p>因为</p>
<p>$S_{j}\left(x_{j}\right)=a_{j}=f\left(x_{j}\right)$</p>
<p>所以条件(c)可用于获得</p>
<p>$a_{j+1}=S_{j+1}\left(x_{j+1}\right)=S_{j}\left(x_{j+1}\right)=a_{j}+b_{j}\left(x_{j+1}-x_{j}\right)+c_{j}\left(x_{j+1}-x_{j}\right)^{2}+d_{j}\left(x_{j+1}-x_{j}\right)^{3}, \quad j=0,1, \cdots, n-2$</p>
<p>$h_{j}=x_{j+1}-x_{j}, \quad j=0,1, \cdots, n-1$</p>
<p>如果定义$a_n=f(x_n)$,则方程：</p>
<p>\begin{equation}
a_{j+1}=a_{j}+b_{j} h_{j}+c_{j} h_{j}^{2}+d_{j} h_{j}^{3}
\end{equation}</p>
<p>对$ j=0,1, \cdots, n-1$ 成立</p>
<p>定义$ b_n=S^{\prime}(x_n)$</p>
<p>$S_{j}^{\prime}(x)=b_{j}+2 c_{j}\left(x-x_{j}\right)+3 d_{j}\left(x-x_{j}\right)^{2}$</p>
<p>可得$$S_{j}^{\prime}\left(x_{j}\right)=b_{j}(j=0,1, \cdots, n-1)$$</p>
<p>应用条件(d)得到：</p>
<p>\begin{equation}
b_{j+1}=b_{j}+2 c_{j} h_{j}+3 d_{j} h_{j}^{2}, \quad j=0,1, \cdots, n-1
\end{equation}</p>
<p>定义$$
c_{n}=S^{\prime\prime}\left(x_{n}\right) / 2
$$</p>
<p>应用条件(e)得到：</p>
<p>\begin{equation}
c_{j+1}=c_{j}+3 d_{j} h_{j}
\end{equation}</p>
<p>在(5)中解出$d_j$并将解出的值带入(3)(4)中，得到新方程：</p>
<p>\begin{equation}
a_{j+1}=a_{j}+b_{j} h_{j}+\frac{h_{j}^{2}}{3}\left(2 c_{j}+c_{j+1}\right)
\end{equation}</p>
<p>\begin{equation}
b_{j+1}=b_{j}+h_{j}\left(c_{j}+c_{j+1}\right)
\end{equation}</p>
<p>解出$b_j$为：</p>
<p>\begin{equation}
b_{j}=\frac{1}{h_{j}}\left(a_{j+1}-a_{j}\right)-\frac{h_{j}}{3}\left(2 c_{j}+c_{j+1}\right)
\end{equation}</p>
<p>即下标减一得：</p>
<p>\begin{equation}
b_{j-1}=\frac{1}{h_{j-1}}\left(a_{j}-a_{j-1}\right)-\frac{h_{j-1}}{3}\left(2 c_{j-1}+c_{j}\right)
\end{equation}</p>
<p>从而得到线性方程组：</p>
<p>\begin{equation}
h_{j-1} c_{j-1}+2\left(h_{j-1}+h_{j}\right) c_{j}+h_{j} c_{j+1}=\frac{3}{h_{j}}\left(a_{j+1}-a_{j}\right)-\frac{3}{h_{j-1}}\left(a_{j}-a_{j-1}\right)
\end{equation}</p>
<p>对于以下四种边界，$$
a_{0}=f\left(x_{0}\right), a_{1}=f\left(x_{1}\right), \cdots, a_{n}=f\left(x_{n}\right)
$$
在解出$$ c_0 \cdots c_n$$后均有以下公式计算：</p>
<p>$$
\begin{array}{l}{b_{j}=\left(a_{j+1}-a_{j}\right) / h_{j}-h_{j}\left(c_{j+1}+2 c_{j}\right) / 3} \ {d_{j}=\left(c_{j+1}-c_{j}\right) /\left(3 h_{j}\right)}\end{array}
$$</p>
<p>现在分析如何解出$$ c_0 \cdots c_n$$</p>
<p>1.对于自然边界：</p>
<p>$$S^{\prime\prime}(a)=0 $$ </p>
<p>$$S^{\prime\prime}(b)=0 $$</p>
<p>得到$$ c_0=0,c_n=0$$</p>
<p>可得矢量方程$$ Ax=b$$</p>
<p>A为$$ (n+1)\times (n+1)$$矩阵</p>
<p>$$
A=\left[\begin{array}{lllllll}
{1} &amp; {0} &amp; {0} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} \ 
{h_{0}} &amp; {2\left(h_{0}+h_{1}\right)} &amp; {h_{1}} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} \ 
{0} &amp; {\cdots} &amp; {h_{1} } &amp; {2\left(h_{1}+h_{2}\right)} &amp; {h} &amp; {\cdots} &amp; {\cdots} \ 
{\vdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} \ 
{\vdots} &amp; {} &amp; {\cdots} &amp; {\cdots} &amp; {h_{n-2}} &amp; { 2(h_{n-2}+h_{n-1})} &amp; {h_{n-1}} \ 
{0} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots}  &amp; {0} &amp; {0} &amp; {1}
\end{array}\right]
$$</p>
<p>b和x为向量：</p>
<p>$$
b=\left[\begin{array}{c}{0} \ {\frac{3}{h_{1}}\left(a_{2}-a_{1}\right)-\frac{3}{h_{0}}\left(a_{1}-a_{0}\right)} \ {\vdots} \ {\frac{3}{h_{n-1}}\left(a_{n}-a_{n-1}\right)-\frac{3}{h_{n-2}}\left(a_{n-1}-a_{n-2}\right)} \ {0}\end{array}\right]
$$</p>
<p>$$
\boldsymbol{x}=\left[\begin{array}{c}{c_{0}} \ {c_{1}} \ {\vdots} \ {c_{n}}\end{array}\right]
$$</p>
<p>2.固定边界</p>
<p>$$ S^{\prime}(x_0)=f^{\prime}(x_0)$$</p>
<p>$$ S^{\prime}(x_n)=f^{\prime}(x_n)$$</p>
<p>$$
b_{0}=f^{\prime}(x_0)=\frac{1}{h_{0}}\left(a_{1}-a_{0}\right)-\frac{h_{0}}{3}\left(2 c_{0}+c_{1}\right)
$$</p>
<p>$$
b_{n-1}=f^{\prime}(x_{n-1})=\frac{1}{h_{n-1}}\left(a_{n}-a_{n-1}\right)-\frac{h_{n-1}}{3}\left(2 c_{n-1}+c_{n}\right)
$$
可得矢量方程$$ Ax=b$$</p>
<p>A为$$ (n+1)\times (n+1)$$矩阵</p>
<p>$$
A=\left[\begin{array}{lllllll}
{2h_0} &amp; {h_0} &amp; {0} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} \ 
{h_{0}} &amp; {2\left(h_{0}+h_{1}\right)} &amp; {h_{1}} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} \ 
{0} &amp; {\cdots} &amp; {h_{1} } &amp; {2\left(h_{1}+h_{2}\right)} &amp; {h} &amp; {\cdots} &amp; {\cdots} \ 
{\vdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} \ 
{\vdots} &amp; {} &amp; {\cdots} &amp; {\cdots} &amp; {h_{n-2}} &amp; { 2(h_{n-2}+h_{n-1})} &amp; {h_{n-1}} \ 
{0} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots}  &amp; {0} &amp; {h_{n-1}} &amp; {2h_{n-1}}
\end{array}\right]
$$</p>
<p>b和x为向量：</p>
<p>$$
b=\left[\begin{array}{c}{\frac{3}{h_{1}}\left(a_{2}-a_{1}\right)-{3}{f^{\prime}(a)}} \ {\frac{3}{h_{1}}\left(a_{2}-a_{1}\right)-\frac{3}{h_{0}}\left(a_{1}-a_{0}\right)} \ {\vdots} \ {\frac{3}{h_{n-1}}\left(a_{n}-a_{n-1}\right)-\frac{3}{h_{n-2}}\left(a_{n-1}-a_{n-2}\right)} \ {3}{f^{\prime}(b)}-\frac{3}{h_{n-1}}(a_n-a_{n-1})\end{array}\right]
$$</p>
<p>$$
\boldsymbol{x}=\left[\begin{array}{c}{c_{0}} \ {c_{1}} \ {\vdots} \ {c_{n}}\end{array}\right]
$$</p>
<p>3.周期边界
$$b_0=b_n
$$</p>
<p>$$
c_0=c_n
$$</p>
<p>可得矢量方程$$ Ax=b$$</p>
<p>A为$$ (n+1)\times (n+1)$$矩阵</p>
<p>$$
A=\left[\begin{array}{lllllll}
{\frac{2}{3}h_0} &amp; {\frac{1}{3}h_0} &amp; {0} &amp; {\cdots} &amp; {\cdots} &amp; {-\frac{2}{3}h_{n-1}} &amp; {-\frac{1}{3}h_{n-1}} \ 
{h_{0}} &amp; {2\left(h_{0}+h_{1}\right)} &amp; {h_{1}} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} \ 
{0} &amp; {\cdots} &amp; {h_{1} } &amp; {2\left(h_{1}+h_{2}\right)} &amp; {h} &amp; {\cdots} &amp; {\cdots} \ 
{\vdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} \ 
{\vdots} &amp; {} &amp; {\cdots} &amp; {\cdots} &amp; {h_{n-2}} &amp; { 2(h_{n-2}+h_{n-1})} &amp; {h_{n-1}} \ 
{1} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots}  &amp; {0} &amp; {0} &amp; {-1}
\end{array}\right]
$$</p>
<p>b和x为向量：</p>
<p>$$
b=\left[\begin{array}{c}{ \frac{1}{h_0}(a_1-a_0) - \frac{1}{h_{n-1}}(a_{n}-a_{n-1})} \ {\frac{3}{h_{1}}\left(a_{2}-a_{1}\right)-\frac{3}{h_{0}}\left(a_{1}-a_{0}\right)} \ {\vdots} \ {\frac{3}{h_{n-1}}\left(a_{n}-a_{n-1}\right)-\frac{3}{h_{n-2}}\left(a_{n-1}-a_{n-2}\right)} \ {0}\end{array}\right]
$$</p>
<p>$$
\boldsymbol{x}=\left[\begin{array}{c}{c_{0}} \ {c_{1}} \ {\vdots} \ {c_{n}}\end{array}\right]
$$</p>
<p>4.强制第一个子区间和第二个子区间样条多项式的三阶导数相同，倒数第二个子区间和最后一个子区间的三次样条函数的三阶导数相等</p>
<p>可得矢量方程$$ Ax=b$$</p>
<p>A为$$ (n+1)\times (n+1)$$矩阵</p>
<p>$$
A=\left[\begin{array}{lllllll}
{1} &amp; {-1} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} \ 
{h_{0}} &amp; {2\left(h_{0}+h_{1}\right)} &amp; {h_{1}} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} \ 
{0} &amp; {\cdots} &amp; {h_{1} } &amp; {2\left(h_{1}+h_{2}\right)} &amp; {h} &amp; {\cdots} &amp; {\cdots} \ 
{\vdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots} \ 
{\vdots} &amp; {} &amp; {\cdots} &amp; {\cdots} &amp; {h_{n-2}} &amp; { 2(h_{n-2}+h_{n-1})} &amp; {h_{n-1}} \ 
{0} &amp; {\cdots} &amp; {\cdots} &amp; {\cdots}  &amp; {0} &amp; {1} &amp; {-1}
\end{array}\right]
$$</p>
<p>b和x为向量：</p>
<p>$$
b=\left[\begin{array}{c}{ 0} \ {\frac{3}{h_{1}}\left(a_{2}-a_{1}\right)-\frac{3}{h_{0}}\left(a_{1}-a_{0}\right)} \ {\vdots} \ {\frac{3}{h_{n-1}}\left(a_{n}-a_{n-1}\right)-\frac{3}{h_{n-2}}\left(a_{n-1}-a_{n-2}\right)} \ {0}\end{array}\right]
$$</p>
<p>$$
\boldsymbol{x}=\left[\begin{array}{c}{c_{0}} \ {c_{1}} \ {\vdots} \ {c_{n}}\end{array}\right]
$$</p>
<p>\newpage</p>
<p>\section{第四章数值微分与数值积分}
\subsection{problem 1}</p>
<p>1.编制复合梯形公式、Simpson公式的计算程序。</p>
<p>2.取 h=0.01,分别利用复合梯形、Simpson公式计算定积分：</p>
<p>$ I(f)=\frac{1}{\sqrt{2 \pi}} \int_{0}^{1} \exp ^{-\frac{x^{2}}{2}} \mathrm{d} x $</p>
<p>3.取计算精度为$ 10 ^ {-4} $，则h=？，n=？</p>
<p>python实现代码如下：
\begin{lstlisting}
    import math</p>
<div class="codehilite"><pre>from scipy import integrate


def f(x):
    t = 1 / pow(2 * math.pi, 0.5)
    return t * pow(math.e, (-0.5 * x * x))


truevalue, e = integrate.quad(f, 0, 1)

print(truevalue)

n1 = 1000
n2 = 1000


# n % 2 ==0
def Simpson(a=0, b=1, n=n1):
    h = (b - a) / n
    fx = []
    for i in range(n + 1):
        fx.append(f(a + h * i))
    res = 0
    for i in range(n + 1):
        if i == 0:
            res += fx[i]
            continue
        if i == n:
            res += fx[i]
            continue
        if i % 2 == 0:
            res += 2 * fx[i]
        if i % 2 == 1:
            res += 4 * fx[i]
    res = res * h / 3
    error = truevalue - res
    return res, error


def Compsite(a=0, b=1, n=n2):
    h = (b - a) / n
    fx = []
    for i in range(n + 1):
        fx.append(f(a + h * i))
    res = 0
    for i in range(n + 1):
        if i == 0:
            res += fx[i]
            continue
        if i == n:
            res += fx[i]
            continue
        res += 2 * fx[i]
    res = res * h / 2
    error = truevalue - res
    return res, error


print(&#39;SIMPSON&#39;, Simpson())
print(&#39;Compsite&#39;, Compsite())

error0 = 1e-4


def find1(a=0, b=1, error=error0):
    res = 0
    for i in range(10, 1000):
        v, e = Simpson(a=a, b=b, n=i)
        if abs(e) &lt; error:
            res = i
            break
    h = (b - a) / res
    n = res
    return h, n


def find2(a=0, b=1, error=error0):
    res = 0
    for i in range(10, 1000):
        v, e = Compsite(a=a, b=b, n=i)
        if abs(e) &lt; error:
            res = i
            break
    h = (b - a) / res
    n = res
    return h, n


print(find1())
print(find2())
</pre></div>


<p>\end{lstlisting}</p>
<p>使用scipy的integrate模块的到精确解为0.341344746068543</p>
<p>在同样迭代1000轮的情况下
使用复合梯形公式计算结果为：0.341344746068546,误差为$ -2.9976021664879227 \times 10^{-15} $</p>
<p>使用Simpson公式计算结果为：0.3413447259043159,误差为$ 2.01642270658553 \times 10^{-8} $</p>
<p>对于复合梯形公式，取计算精度为$ 10 ^ {-4} $，则h=0.1 ，n=10</p>
<p>对于复合梯形公式，取计算精度为$ 10 ^ {-4} $，则h=0.06666666666666667 ，n=15
\newpage
\subsection{作业推导}
~\
1(i).推导复合梯形公式及其误差估计</p>
<p>证明：</p>
<p>在每个子区间$$[x_{k-1},x_k]$$上应用梯形公式</p>
<p>$$\int_{a}^{b} = \Sigma_{k=1}^{M} \int_{x_{k-1}}^{x_k} \approx \Sigma_{k=1}^{M} \frac{h}{2} ((f(x_{k-1}))+(f(x_k))) $$</p>
<p>由于$\frac{h}{2}$ 为常数，由加法分配律可得</p>
<p>$$
T(f,h)= \frac{h}{2} \Sigma_{k=1}^{M}  ((f(x_{k-1}))+(f(x_k)))
$$</p>
<p>或</p>
<p>$$
T(f,h)=\frac{h}{2} (f(a)+f(b)) + h \Sigma_{k=1}^{M-1} x_k
$$</p>
<p>它们是区间[a,b]上f(x)积分的逼近，记为：</p>
<p>$$
\int_{b}^{a} f(x) dx \approx T(f,h)$$</p>
<p>$$
E_T (f,h)=a_1h^2+a_2h^4+a_3h^6\cdots
$$</p>
<p>~\</p>
<p>1(ii).推导基于误差控制的逐次半积分梯形公式及其误差估计</p>
<p>运用梯形公式：</p>
<p>$$\int_{a}^{b} f(x) dx =T(f,h)+E_T (f,h)$$</p>
<p>$$
E_T (f,h)=a_1h^2+a_2h^4+a_3h^6\cdots
$$</p>
<p>$$
\int_{a}^{b} f(x) dx=T(f,h)+a_1h^2+a_2h^4+a_3h^6\cdots
$$</p>
<p>$$
4\int_{a}^{b} f(x) dx=4T(f,h)+4a_1h^2+4a_2h^4+4a_3h^6\cdots
$$</p>
<p>$$
\int_{a}^{b} f(x) dx=T(f,2h)+a_14h^2+a_216h^4+a_364h^6\cdots
$$</p>
<p>下减上得</p>
<p>$$
\int_{a}^{b} f(x) dx=\frac{4T(f,h)-T(f,2h)}{3}+b_1h^4+b_2h^6\cdots
$$</p>
<p>误差降低为 $O(h^4)$</p>
<p>~\
2.let $ h= \frac{b-a}{3} , x_0=a,x_1=a+h,x_2=b$.Find the degree of percision of the quadrature formula</p>
<p>$$\int_{a}^{b} f(x) dx=\frac{9}{4}hf(x_1)+\frac{3}{4}hf(x_2)$$</p>
<p>解：</p>
<p>$$
\delta =b-a
$$</p>
<p>$$
T(f,b-a)=\frac{1}{2} (b-a) (f(x_0)+f(x_2)) 
= \frac{1}{2} \delta (f(x_0)+f(x_2)) 
$$</p>
<p>$$
T(f,\frac{b-a}{3})-=\frac{1}{2} \frac{1}{3}(b-a) (f(x_0)+f(x_1))  +\frac{1}{2} \frac{2}{3}(b-a) (f(x_1)+f(x_2))
$$</p>
<p>$$
= \frac{1}{6} \delta f(x_0)+ \frac{1}{2} \delta f(x_1) + \frac{1}{3} \delta f(x_2)
$$</p>
<p>3倍的下减上得：</p>
<p>$$
\int_{a}^{b} f(x) dx \approx \frac{3T(f,\frac{b-a}{3})-T(f,b-a)}{2}
$$</p>
<p>$$
E_T (f,3h)=\frac{(3h)f^{(2)}(c_1)(3h)^2}{12}
$$</p>
<p>$$
E_T (f,h)=\frac{(h)f^{(2)}(c_2)(h)^2}{12}+\frac{(2h)f^{(2)}(c_3)(2h)^2}{12}
$$</p>
<p>$$
Error=3E_T (f,h)-E_T (f,3h)=O(h^4)
$$</p>
<p>\newpage</p>
<p>\section{第五章常微分方程数值解}</p>
<p>\subsection{problem 1}
求$ y^{\prime}=1+y^{2}, y(0)=0$ 的数值解（分别用欧拉显格式、梯形预估修正格式、4阶龙格库塔格式，并与解析解比较三种格式的收敛性）</p>
<p>python实现代码如下：
\begin{lstlisting}  </p>
<div class="codehilite"><pre>import numpy as np
import matplotlib.pyplot as plt
import math

N = 10


def f(t, w):
    return 1 + w * w


def pt(res, color):
    plt.scatter(np.array(res).T[0], np.array(res).T[1], color=color)


def inplot():
    x = np.linspace(0, np.pi / 2.2, 100, endpoint=True)
    y = np.tan(x)
    plt.plot(x, y, color=&#39;pink&#39;, linewidth=3)


def Euler(a=0, b=math.pi / 2.2, n=N, alpha=0):
    h = (b - a) / n
    t = a
    w = alpha
    res = [[t, w]]
    for i in range(1, n):
        w += h * f(t, w)
        t += h
        res.append([t, w])

    return res


def improvedEuler(a=0, b=math.pi / 2.2, n=N, alpha=0):
    h = (b - a) / n
    t = a
    w = alpha
    res = [[t, w]]
    for i in range(1, n):
        t1 = w + h * f(t, w)
        w += h / 2 * (f(t, w) + f(t + h, t1))
        t += h
        res.append([t, w])
    return res


def RungeKutta(a=0, b=math.pi / 2.2, n=N, alpha=0):
    h = (b - a) / n
    t = a
    w = alpha
    res = [[t, w]]
    for i in range(1, n):
        k1 = h * f(t, w)
        k2 = h * f(t + h / 2, w + k1 / 2)
        k3 = h * f(t + h / 2, w + k2 / 2)
        k4 = h * f(t + h / 2, w + k3)
        w += (k1 + 2 * k2 + 2 * k3 + k4) / 6
        t += h
        res.append([t, w])
    return res


res1 = Euler()
pt(res1, &#39;green&#39;)

res2 = improvedEuler()
pt(res2, &#39;red&#39;)

res3 = RungeKutta()
pt(res3, &#39;blue&#39;)

inplot()

plt.show()
</pre></div>


<p>\end{lstlisting}
\begin{figure}[H]
 \centering0
  \includegraphics[width=10cm,height=9cm]{6-0.png}
  \caption{green:Euler,red:improvedEuler,blue:RungeKutta}
\end{figure}</p>
<p>由收敛图像可见，欧拉显格式、梯形预估修正格式、4阶龙格库塔格式，三者收敛速率逐个下降。</p>
<p>\subsection{problem 2}</p>
<p>用龙格库塔4阶方法求解描述振荡器的经典的van der Plo 微分方程：</p>
<p>$\left{\begin{array}{l}{\frac{\mathrm{d}^{2} y}{\mathrm{d} t^{2}}-\mu\left(1-y^{2}\right) \frac{\mathrm{d} y}{\mathrm{d} t}+y=0} \ {y(0)=1, y^{\prime}(0)=0}\end{array}\right.$</p>
<p>分别取$ \mu =0.01 ,0.1 ,1$ ，作图比较计算结果</p>
<p>python实现代码如下：</p>
<p>\begin{lstlisting}<br />
    import numpy as np
    import matplotlib.pyplot as plt
    import math</p>
<div class="codehilite"><pre>N = 1000
mu = 0.01


def f1(t, w1, w2):
    return w2


def f2(t, w1, w2):
    return mu * (1 - w1 * w1) * w2 - w1


def pt(res):
    plt.plot(np.array(res).T[0], np.array(res).T[1])
    plt.show()
    plt.plot(np.array(res).T[0], np.array(res).T[2])
    plt.show()

def RungeKutta2(a=0, b=10, n=N, alpha=1 , alpha1=0):
    h = (b - a) / n
    t = a
    w1 = alpha
    w2 = alpha1
    res=[[t,w1,w2]]
    for i in range(N):
        k11=h*f1(t,w1,w2)
        k12=h*f2(t,w1,w2)
        k21=h*f1(t+h/2,w1+k11/2,w2+k12/2)
        k22=h*f2(t+h/2,w1+k11/2,w2+k12/2)
        k31=h*f1(t+h/2,w1+k21/2,w2+k22/2)
        k32=h*f2(t+h/2,w1+k21/2,w2+k22/2)
        k41=h*f1(t+h/2,w1+k31/2,w2+k32/2)
        k42=h*f2(t+h/2,w1+k31/2,w2+k32/2)
        w1+=(k11+2*k21+2*k31+k41)/6
        w2+=(k12+2*k22+2*k32+k42)/6
        t+=h
        res.append([t,w1,w2])
    return res


res=RungeKutta2()
pt(res)
</pre></div>


<p>\end{lstlisting}
$ \mu =0.01 $时：</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{6-001-01.png}
  \caption{y-t}
\end{figure}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{6-001-02.png}
  \caption{y&rsquo;-t}
\end{figure}</p>
<p>$ \mu =0.1 $时：</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{6-01-01.png}
  \caption{y-t}
\end{figure}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{6-01-02.png}
  \caption{y&rsquo;-t}
\end{figure}</p>
<p>$ \mu =1 $时：</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{6-1-01.png}
  \caption{y-t}
\end{figure}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{6-1-02.png}
  \caption{y&rsquo;-t}
\end{figure}</p>
<p>\newpage</p>
<p>\section{第八章曲线拟合与函数逼近}</p>
<p>已知观测数据：</p>
<p>\begin{table}[H]
\centering
\caption{x-f(X)}
\begin{tabular}{|l|l|l|l|l|l|}
\hline</p>
<p>x &amp; -2 &amp; -1 &amp; 0 &amp; 1 &amp; 2 \ \hline
f(x) &amp; 0  &amp; 1 &amp; 2 &amp; 1 &amp; 0 \ \hline</p>
<p>\end{tabular}
\end{table}</p>
<p>求一个二次多项式拟合数据，写出最小二乘拟合模型，给出正则方程组及其解</p>
<p>python实现代码如下：
\begin{lstlisting}<br />
    import numpy as np</p>
<div class="codehilite"><pre>x_array = np.array([-2, -1, 0, 1, 2])
y_array = np.array([0,1,2,1,0])
n = 2
m = len(x_array)

A = np.ones(m).reshape((m, 1))
for i in range(n):
    A = np.hstack([A, (x_array ** (i + 1)).reshape((m, 1))])

from numpy.linalg import solve
alpha=np.dot(A.T, A)
belta= np.dot(A.T, y_array.T)
X = solve(alpha,belta)
print(X)
print(alpha)
print(belta)
import matplotlib.pyplot as plt

x = np.linspace(-3, 3, 100, endpoint=True)
y = X[2]*x*x+X[1]*x+X[0]
plt.plot(x, y,color=&#39;pink&#39;,linewidth=1)
plt.scatter(x_array,y_array)
plt.show()
</pre></div>


<p>\end{lstlisting}</p>
<p>\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{8.png}
  \caption{拟合图像}
\end{figure}</p>
<p>拟合方程为$ y=1.65714286-0.42857143x^2$</p>
<p>正则方程组如下：</p>
<p>$5X_0+0+10X_2=4 $</p>
<p>$0+10X_1+0=0 $</p>
<p>$10X_0+0+34X_2=2 $</p>
<p>方程的解为：$X_0=1.65714286 , X_1=0 , X_2=-0.42857143$
\newpage</p>
<p>\section{第九章特征值与特征向量}
\subsection{problem 1}
已知矩阵：</p>
<p>$\mathbf{A}=\left[\begin{array}{ccc}{4} &amp; {-1} &amp; {1} \ {-1} &amp; {3} &amp; {-2} \ {1} &amp; {-2} &amp; {3}\end{array}\right]$</p>
<p>是一个对称矩阵，且其特征值为$ \lambda_1 =6, \lambda_2 =3, \lambda_3 =1 $,</p>
<p>分别利用幂法、对称幂法、反幂法求其最大特征值和特征向量。</p>
<p>初始向量$ \mathbf{x}^{(0)}=(1\quad 1 \quad1)^{T} $
python实现代码如下：
\begin{lstlisting}
    import numpy as np</p>
<div class="codehilite"><pre>A0 = [
    [4, -1, 1],
    [-1, 3, -2],
    [1, -2, 3]
]
A = np.array(A0)




def findmax(x):
    t = np.abs(x).tolist()
    xmax = np.max(t)
    res = 0
    for i in range(len(t)):
        if t[i] == xmax:
            res = i
            break
    return xmax, res


def f1(N=1000000, TOL=1e-18):
    xr=[]
    x = [1, 1, 1]
    X = np.array(x).T
    k = 1
    xmax, p = findmax(X)
    X = X / xmax
    while k &lt; N:
        k += 1
        y = np.matmul(A, X)
        ymax, yp = findmax(y)
        mu = ymax
        xr.append(mu)
        if ymax == 0:
            print(X)
            print(&#39;please reselect x&#39;)
            break
        err, no = findmax(X - (y.T) / ymax)
        X = y.T / ymax

        if err &lt; TOL:
            xm, xp = findmax(X)
            return mu, X/xm, k,xr
            break


print(f1())


def two(X):
    sum = 0
    for i in X:
        sum += i * i
    sum = pow(sum, 0.5)
    return sum


def f2(N=1000000, TOL=1e-18):
    x = [1, 1, 1]
    xr = []
    X = np.array(x).T
    X = X / two(X)
    k = 1
    while k &lt;= N:
        k += 1
        y = np.matmul(A, X)
        mu = np.matmul(X.T, y)
        xr.append(mu)
        if two(y) == 0:
            print(&#39;Eig&#39;, X)
            print(&#39;reselect&#39;)
        ERR = two(X - y / two(y))
        X = y / two(y)
        if ERR &lt; TOL:
            xm,xp=findmax(X)
            return mu, X/xm, k,xr


print(f2())


def cal(A, B):
    x = np.linalg.solve(A, B)
    return x.T


def calq(X):
    q = np.matmul(np.matmul(X.T, A), X) / np.matmul(X.T, X)
    return q


def f3(N=100000, TOL=1e-18):
    x = [1, -0.1, 0.2]
    xr=[]
    X = np.array(x).T
    k = 1
    q = calq(X)
    xr.append(q)
    xmax, xp = findmax(X)
    X = X / xmax

    while k &lt;= N:
        k += 1
        I = np.eye(len(A))
        q = calq(X)
        xr.append(q)
        try:
            y = np.array(cal(A - q * I, X)).T
        except:
            ymax, yp = findmax(y)
            return q, y/ ymax, k,xr
        else:
            ymax, yp = findmax(y)
            mu = ymax
            ERR, no = findmax(X - (y / ymax))
            X = y / ymax

            if ERR &lt; TOL:
                mu = (1 / mu) + q
                xm, xp = findmax(X)
                return mu, X/xm, k,xr


print(f3())
</pre></div>


<p>\end{lstlisting}</p>
<p>实验结果：</p>
<p>1.幂法获得最大特征值为6，特征向量为$ (1\quad -1 \quad1)^{T}$,迭代次数为57，误差为$ 10^{-18}$</p>
<p>2.对称幂法获得最大特征值为6，特征向量为$ (1\quad -1 \quad1)^{T}$,迭代次数为56，误差为$ 10^{-18}$</p>
<p>3.反幂法获得最大特征值为6，特征向量为$ (1\quad -1 \quad1)^{T}$,迭代次数为8，误差为$ 10^{-18}$</p>
<p>\subsection{problem 2}</p>
<p>对于数据：</p>
<p>$\mathbf{A}=\left[\begin{array}{ccc}{1} &amp; {-1} &amp; {1.0} \ 
                                    {1} &amp; {-0.5} &amp; {0.25} \ 
                                    {1} &amp; {0.0} &amp; {0.0} \ 
                                    {1} &amp; {0.5} &amp; {0.25} \
                                     {1} &amp; {1.0} &amp; {1.0}\end{array}\right]$</p>
<p>$ \mathbf{b}=\left[\begin{array}{l}{1.0} \ {0.5} \ {0.0} \ {0.5} \ {2.0}\end{array}\right]$</p>
<p>进行Household变换，输出$H_1,H_2,H_3$</p>
<p>python实现代码如下：
\begin{lstlisting}<br />
    import numpy as np</p>
<div class="codehilite"><pre>a = [
    [1, -1, 1],
    [1, -0.5, 0.25],
    [1, 0, 0],
    [1, 0.5, 0.25],
    [1, 1, 1]
]
b = [1, 0.5, 0, 0.5, 2]
I = np.eye(5)

A = np.array(a).T
B = np.array(b).T


def vvt(v):
    res = np.zeros((len(v),len(v)))
    for i in range(len(v)):
        for j in range(len(v)):
            res[i][j] = v[i] * v[j]
    return res



def vtv(v):
    sum = 0
    for i in range(len(v)):
            sum  += v[i] * v[i]
    return sum

def vvt1(v):
    return vvt(v)/vtv(v)


def H(v):
    I=np.eye(len(v))
    H=I-2*vvt1(v)
    return H

def HA(v,A):
    return np.matmul(H(v),A.T)

def HB(H,B):
    return np.matmul(H,B)


def createv(A,A0,k,j):
    s1=0
    for i in range(k,len(A0[k])):
        s1+=pow(A0[k][i],2)
    s1=pow(s1,0.5)
    res=[]
    for fk in A[k]:
        res.append(fk)
    for i in range(j):
        res[i]=0
    if A[k][j]&gt;0:
        res[j]+=s1
    else:
        res[j]-=s1
    return res
v1=createv(A,A,0,0)
H1=H(v1)
A1=np.array(HA(v1,A))
print(A1)
A1=A1.T
v2=createv(A1,A,1,1)
H2=H(v2)
A2=np.array(HA(v2,A1))
print(A2)
A2=A2.T
v3=createv(A2,A,2,2)
H3=H(v3)
A3=HA(v3,A2)
print(A3)


B1=HB(H1,B)
print(B1)
B2=HB(H2,B1)
print(B2)
B3=HB(H3,B2)
print(B3)
</pre></div>


<p>\end{lstlisting}
实验结果：
$\mathbf{H_1}=\left[\begin{array}{cccccc}
                                    {-0.4472}&amp;{-0.4472}&amp;{-0.4472}&amp;{-0.4472}&amp;{-0.4472}\
{-0.4472}&amp;{0.86180}&amp;{-0.1381}&amp;{-0.1381}&amp;{-0.1381}\
{-0.4472}&amp;{-0.1381}&amp;{0.86180}&amp;{-0.1381}&amp;{-0.1381}\
{-0.4472}&amp;{-0.1381}&amp;{-0.1381}&amp;{0.86180}&amp;{-0.1381}\
{-0.4472}&amp;{-0.1381}&amp;{-0.1381}&amp;{-0.1381}&amp;{0.86180}
                                     \end{array}\right]$</p>
<p>$\mathbf{H_2}=\left[\begin{array}{cccccc}
                                    {1.0}&amp;{0.0}&amp;{0.0}&amp;{0.0}&amp;{0.0}\
{0.0}&amp;{0.10278}&amp;{0.19583}&amp;{0.51271}&amp;{0.82958}\
{0.0}&amp;{0.19583}&amp;{0.95725}&amp;{-0.1119}&amp;{-0.1810}\
{0.0}&amp;{0.51271}&amp;{-0.1119}&amp;{0.70701}&amp;{-0.4740}\
{0.0}&amp;{0.82958}&amp;{-0.1810}&amp;{-0.4740}&amp;{0.23294}
                                     \end{array}\right]$</p>
<p>$\mathbf{H_3}=\left[\begin{array}{cccccc}
                                    {1.0}&amp;{0.0}&amp;{0.0}&amp;{0.0}&amp;{0.0}\
{0.0}&amp;{1.0}&amp;{0.0}&amp;{0.0}&amp;{0.0}\
{0.0}&amp;{0.0}&amp;{-0.7988}&amp;{-0.5989}&amp;{0.05660}\
{0.0}&amp;{0.0}&amp;{-0.5989}&amp;{0.80059}&amp;{0.01884}\
{0.0}&amp;{0.0}&amp;{0.05660}&amp;{0.01884}&amp;{0.99821}
                                     \end{array}\right]$</p>
<p>用以上$H_1,H_2,H_3$得出的$H_1A,H_1b,H_2H_1A,H_2H_1b,H_3H_2H_1A,H_3H_2H_1b$如下：</p>
<p>$\mathbf{H_1A}=\left[\begin{array}{cccccc}
                                    {-2.2360}&amp;{5.55111}&amp;{5.55111}&amp;{2.77555}&amp;{0.0}\
{-5.5511}&amp;{-0.1909}&amp;{0.30901}&amp;{0.80901}&amp;{1.30901}\
{-1.1180}&amp;{-0.4045}&amp;{-0.6545}&amp;{-0.4045}&amp;{0.34549}
                                     \end{array}\right]$</p>
<p>$\mathbf{H_1b}=\left[\begin{array}{cccccc}
                                    {-1.7888}\
{-0.3618}\
{-0.8618}\
{-0.3618}\
{1.13819}
                                     \end{array}\right]$</p>
<p>$\mathbf{H_2H_1A}=\left[\begin{array}{cccccc}
                                    {-2.2360}&amp;{3.08077}&amp;{6.09032}&amp;{4.18723}&amp;{2.28414}\
{-5.5511}&amp;{1.54161}&amp;{-0.0691}&amp;{-0.1810}&amp;{-0.2929}\
{-1.1180}&amp;{-0.0905}&amp;{-0.7230}&amp;{-0.5839}&amp;{0.05518}
                                     \end{array}\right]$</p>
<p>$\mathbf{H_2H_1b}=\left[\begin{array}{cccccc}
                                    {-1.7888}\
{0.55276}\
{-1.0614}\
{-0.8844}\
{0.29256}
                                     \end{array}\right]$</p>
<p>$\mathbf{H_3H_2H_1A}=\left[\begin{array}{cccccc}
                                    {-2.2360}&amp;{-5.5511}&amp;{-1.1180}\
{3.08077}&amp;{1.54161}&amp;{-0.0905}\
{-7.2435}&amp;{0.14711}&amp;{0.93041}\
{-2.5222}&amp;{-0.1090}&amp;{-0.0334}\
{2.70371}&amp;{-0.2997}&amp;{0.00315}
                                     \end{array}\right]$</p>
<p>$\mathbf{H_3H_2H_1b}=\left[\begin{array}{cccccc}
                                    {-1.7888}\
{0.55276}\
{1.39414}\
{-0.0668}\
{0.21529}
                                     \end{array}\right]$</p>
<p>验证完毕</p>
<p>\newpage
\section{2001年建模A题}
python实现代码如下：
\begin{lstlisting}
    import cv2
    import matplotlib.pyplot as plt
    import numpy as np
    path=&rdquo;D:\jm2001A\cumcm2001a-bmp&rdquo;</p>
<div class="codehilite"><pre>pic=[]

for i in range(100):
    pic.append(cv2.imread(path+&quot;\\&quot;+str(i)+&quot;.bmp&quot;))

print(pic[0][0][0]) #100 * 512*512*3

zos=np.zeros((512,512))

pic1=[]
for i in range(100):
    zos = np.zeros((512, 512))
    for j in range(512):
        for k in range(512):
            if pic[i][j][k][0]!=255 or pic[i][j][k][1]!=255 
            or pic[i][j][k][2]!=255:
                zos[j][k]=1
    pic1.append(zos)


points=[]
for k in range(100):
    from sklearn.cluster import KMeans
    temp=[]
    for i in range(512):
        for j in range(512):
            if pic1[k][i][j]==1:
                temp.append([i,j])
    kmeans = KMeans(init=&#39;k-means++&#39;, n_clusters=1, n_init=10)
    kmeans.fit(temp)
    points.append(kmeans.cluster_centers_[0])
    print(k)


points3D=[]
k=1
for i in points:
    points3D.append([i[0],i[1],k*1.0])
    k+=1



import matplotlib.pyplot as plt
import matplotlib.cm as cmx
from mpl_toolkits.mplot3d import Axes3D


pT=np.array(points3D).T
fig = plt.figure()
ax = fig.gca(projection=&#39;3d&#39;) 
cm = plt.cm.get_cmap(&#39;RdYlBu&#39;)
ax.view_init(45, 60)
sc=ax.scatter(pT[0], pT[1], pT[2],c=pT[2], vmin=0, 
vmax=100, s=35, cmap=cm)
plt.colorbar(sc)
plt.show()


plt.plot(pT[0],pT[1])
plt.show()


plt.plot(pT[0],pT[2])
plt.show()


plt.plot(pT[1],pT[2])
plt.show()


#x ~ y
import numpy as np
import matplotlib.pyplot as plt
x = pT[0]
x = np.array(x)
num = pT[1]
y = np.array(num)
f1 = np.polyfit(x, y, 8)
p1 = np.poly1d(f1)
print(&#39;p1 is :\n&#39;,p1)

yvals = p1(x)

plot1 = plt.plot(x, y, &#39;s&#39;,label=&#39;original values&#39;)
plot2 = plt.plot(x, yvals, &#39;r&#39;,label=&#39;polyfit values&#39;)
plt.xlabel(&#39;x&#39;)
plt.ylabel(&#39;y&#39;)
plt.legend(loc=4) 
plt.title(&#39;polyfitting&#39;)
plt.show()


# x ~ z
import numpy as np
import matplotlib.pyplot as plt
x = pT[0]
x = np.array(x)
num = pT[2]
y = np.array(num)
f1 = np.polyfit(x, y, 8)
p1 = np.poly1d(f1)
print(&#39;p1 is :\n&#39;,p1)

yvals = p1(x)

plot1 = plt.plot(x, y, &#39;s&#39;,label=&#39;original values&#39;)
plot2 = plt.plot(x, yvals, &#39;r&#39;,label=&#39;polyfit values&#39;)
plt.xlabel(&#39;x&#39;)
plt.ylabel(&#39;y&#39;)
plt.legend(loc=4) 
plt.title(&#39;polyfitting&#39;)
plt.show()
</pre></div>


<p>\end{lstlisting}
\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{2001_0.png}
  \caption{3D图}
\end{figure}
\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{2001_1.png}
  \caption{x-y}
\end{figure}
\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{2001_2.png}
  \caption{x-z}
\end{figure}
\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{2001_3.png}
  \caption{y-z}
\end{figure}
\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{2001_4.png}
  \caption{拟合图像1}
\end{figure}
\begin{figure}[H]
 \centering
  \includegraphics[width=10cm,height=9cm]{2001_5.png}
  \caption{拟合图像2}
\end{figure}</p>
<p>得到参数方程为：</p>
<p>$$
y=-7.17 \times 10^{(-16)} x^8 +1.488 \times10^{-12} x^7-1.322\times 10^{-9} x^6
$$
$$
+6.554 \times 10^{-7} x^5 -0.0001988 x^4 +0.0373 x^3-4.276 x^2+274x-7214
$$</p>
<p>$$
z=-3.777 \times 10^{(-16)} x^8 +7.931 \times10^{-13} x^7-7.115\times 10^{-10} x^6
$$
$$
+3.556\times 10^{-7} x^5 -0.0001081 x^4 +0.02044 x^3-2.345 x^2+274x-4025
$$</p>
<p>\newpage
\section*{致谢}
感谢刘保东教授和窦金峰学姐一学期来的辛勤指导。</p>
<p>通过对数值计算课程的学习，我学会了用计算机能够更好的解决数学问题。在本门课程实验中，我使用 PYTHON 对数学领域的常用算法进行了学习和编程实现，并进行了误差分析。进行完实验的学习之后，我对计算机和数学之间的联系理解的更加透彻，为以后的科研之路打下了良好的基础。</p>
<p>\end{document}</p></article></body></html>